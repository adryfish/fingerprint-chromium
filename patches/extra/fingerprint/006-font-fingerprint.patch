diff --git a/third_party/blink/renderer/platform/fonts/font_cache.cc b/third_party/blink/renderer/platform/fonts/font_cache.cc
index 34603fc206..5da4b18ab3 100644
--- a/third_party/blink/renderer/platform/fonts/font_cache.cc
+++ b/third_party/blink/renderer/platform/fonts/font_cache.cc
@@ -32,14 +32,17 @@
 #include <limits>
 #include <memory>
 
+#include "base/command_line.h"
 #include "base/debug/alias.h"
 #include "base/feature_list.h"
 #include "base/notreached.h"
 #include "base/strings/escape.h"
+#include "base/strings/string_number_conversions.h"
 #include "base/system/sys_info.h"
 #include "base/timer/elapsed_timer.h"
 #include "base/trace_event/process_memory_dump.h"
 #include "base/trace_event/trace_event.h"
+#include "components/ungoogled/ungoogled_switches.h"
 #include "build/build_config.h"
 #include "skia/ext/font_utils.h"
 #include "third_party/blink/public/common/features.h"
@@ -147,6 +150,120 @@ const FontPlatformData* FontCache::SystemFontPlatformData(
 }
 #endif
 
+// 获取平台特定的字体列表
+static std::vector<std::string> GetPlatformFonts(const std::string& platform) {
+  if (platform == "windows") {
+    return {
+      "Arial", "Arial Black",
+      "Bahnschrift",
+      "Calibri", "Cambria", "Cambria Math", "Candara", "Cascadia Code", "Cascadia Mono", "Comic Sans MS", "Consolas", "Constantia", "Corbel", "Courier New",
+      "Ebrima",
+      "Franklin Gothic Medium",
+      "Gabriola", "Gadugi", "Georgia",
+      "HoloLens MDL2 Assets",
+      "Impact", "Ink Free",
+      "Javanese Text",
+      "Leelawadee UI", "Lucida Console", "Lucida Sans Unicode",
+      "Malgun Gothic", "Marlett", "Microsoft Himalaya", "Microsoft JhengHei", "Microsoft New Tai Lue", "Microsoft PhagsPa", "Microsoft Sans Serif", "Microsoft Tai Le", "Microsoft YaHei", "Microsoft Yi Baiti", "MingLiU-ExtB", "Mongolian Baiti", "MS Gothic", "MV Boli", "Myanmar Text",
+      "Nirmala UI",
+      "Palatino Linotype",
+      "Segoe Fluent Icons", "Segoe MDL2 Assets", "Segoe Print", "Segoe Script", "Segoe UI", "Segoe UI Emoji", "Segoe UI Historic", "Segoe UI Symbol", "Segoe UI Variable", "SimSun", "Sitka", "Sylfaen", "Symbol",
+      "Tahoma", "Times New Roman", "Trebuchet MS",
+      "Verdana",
+      "Webdings", "Wingdings",
+      "Yu Gothic"
+    };
+  } else if (platform == "macos") {
+    return {
+      "Academy Engraved LET", "Adelle Sans Devanagari", "AkayaKanadaka", "AkayaTelivigala", "Al Bayan", "Al Firat", "Al Khalil", "Al Nile", "Al Rafidain", "Al Rafidain Al Fanni", "Al Tarikh", "Algiers", "American Typewriter", "Andale Mono", "Annai MN", "Apple Braille", "Apple Chancery", "Apple Color Emoji", "Apple LiGothic", "Apple LiSung", "Apple SD Gothic Neo", "Apple Symbols", "AppleGothic", "AppleMyungjo", "Arial", "Arial Hebrew", "Arial Narrow", "Arial Rounded MT", "Arial Unicode MS", "Arima Koshi", "Arima Madurai", "Asphalt", "Athelas", "Avenir", "Avenir Next", "Ayuthaya",
+      "Baghdad", "Bai Jamjuree", "Balega", "Baloo 2", "Baloo Bhai 2", "Baloo Bhaijaan", "Baloo Bhaina 2", "Baloo Chettan 2", "Baloo Da 2", "Baloo Paaji 2", "Baloo Tamma 2", "Baloo Tammudu 2", "Baloo Thambi 2", "Bangla MN", "Bangla Sangam MN", "Bank Gothic", "Baoli SC", "Baoli TC", "Baskerville", "Basra", "Bebas Neue", "Beirut", "BiauKaiHK", "BiauKaiTC", "Big Caslon", "BIZ UDGothic", "BIZ UDMincho", "Blackmoor LET", "BlairMdITC TT", "BM DoHyeon OTF", "BM HANNA 11yrs old OTF", "BM HANNA Air OTF", "BM HANNA Pro OTF", "BM JUA OTF", "BM KIRANGHAERANG OTF", "BM YEONSUNG OTF", "Bodoni 72", "Bodoni 72 Oldstyle", "Bodoni 72 Smallcaps", "Bodoni Ornaments", "Book Antiqua", "Bookman Old Style", "Bordeaux Roman Bold LET", "Bradley Hand", "Braganza", "Brill Italic", "Brill Roman", "Brush Script MT",
+      "Cambay Devanagari", "Canela", "Canela Deck", "Canela Text", "Capitals", "Carlito", "Catamaran", "Century Gothic", "Century Schoolbook", "Chakra Petch", "Chalkboard", "Chalkboard SE", "Chalkduster", "Charcoal CY", "Charm", "Charmonman", "Charter", "Cochin", "Comic Sans MS", "Copperplate", "Corsiva Hebrew", "Courier", "Courier New",
+      "Damascus", "Dash", "Dear Joe Four", "DecoType Naskh", "Devanagari MT", "Devanagari Sangam MN", "DFKaiShu-SB-Estd-BF", "Didot", "Dijla", "DIN Alternate", "DIN Condensed", "Diwan Kufi", "Diwan Thuluth", "Domaine Display", "Druk", "Druk Text", "Druk Wide",
+      "Euphemia UCAS",
+      "Fahkwang", "Fakt Slab Stencil Pro", "Farah", "Farisi", "Forgotten Futurist", "Founders Grotesk", "Founders Grotesk Text", "Futura",
+      "Galvji", "Garamond", "GB18030 Bitmap", "Geeza Pro", "Geneva", "Geneva CY", "Georgia", "Gill Sans", "Gotu", "Grantha Sangam MN", "Graphik", "Graphik Compact", "Gujarati MT", "Gujarati Sangam MN", "GungSeo", "Gurmukhi MN", "Gurmukhi MT", "Gurmukhi Sangam MN",
+      "Hannotate SC", "Hannotate TC", "HanziPen SC", "HanziPen TC", "HeadLineA", "Hei", "Heiti SC", "Heiti TC", "Helvetica", "Helvetica CY", "Helvetica Neue", "Herculanum", "Hiragino Kaku Gothic Pro", "Hiragino Kaku Gothic ProN", "Hiragino Kaku Gothic Std", "Hiragino Kaku Gothic StdN", "Hiragino Maru Gothic Pro", "Hiragino Maru Gothic ProN", "Hiragino Mincho Pro", "Hiragino Mincho ProN", "Hiragino Sans", "Hiragino Sans CNS", "Hiragino Sans GB", "Hiragino Sans TC", "Hoefler Text", "Hopper Script", "Hubballi",
+      "Impact", "InaiMathi", "Iowan Old Style", "ITF Devanagari", "ITF Devanagari Marathi",
+      "Jaini", "Jaini Purva", "Jazz LET", "Journal Sans New",
+      "K2D", "Kai", "Kailasa", "Kaiti SC", "Kaiti TC", "Kannada MN", "Kannada Sangam MN", "Katari", "Kavivanar", "Kefa", "Khmer MN", "Khmer Sangam MN", "Kigelia", "Kigelia Arabic", "Klee", "Kodchasan", "Kohinoor Bangla", "Kohinoor Devanagari", "Kohinoor Gujarati", "Kohinoor Telugu", "KoHo", "Kokonor", "Koufi Abjadi", "Krub", "Krungthep", "KufiStandardGK",
+      "Lahore Gurmukhi", "Laimoon", "Lantinghei SC", "Lantinghei TC", "Lao MN", "Lao Sangam MN", "Lava Devanagari", "Lava Kannada", "Lava Telugu", "Libian SC", "Libian TC", "LiHei Pro", "LingWai SC", "LingWai TC", "LiSong Pro", "Lucida Grande", "Luminari",
+      "Maku", "Malayalam MN", "Malayalam Sangam MN", "Mali", "Marion", "Marker Felt", "Menlo", "Microsoft Sans Serif", "Mishafi", "Mishafi Gold", "Modak", "Mona Lisa Solid ITC TT", "Monaco", "Mshtakan", "Mukta", "Mukta Malar", "Mukta Vaani", "MuktaMahee", "Muna", "Myanmar MN", "Myanmar Sangam MN", "Myriad Arabic",
+      "Nadeem", "Nanum Brush Script", "Nanum Pen Script", "NanumGothic", "NanumMyeongjo", "New Peninim MT", "Niramit", "Nisan", "Nom Na Tong", "Noteworthy", "Noto Nastaliq Urdu", "Noto Sans Adlam", "Noto Sans Armenian", "Noto Sans Avestan", "Noto Sans Bamum", "Noto Sans Bassa Vah", "Noto Sans Batak", "Noto Sans Bhaiksuki", "Noto Sans Brahmi", "Noto Sans Buginese", "Noto Sans Buhid", "Noto Sans Canadian Aboriginal", "Noto Sans Carian", "Noto Sans Caucasian Albanian", "Noto Sans Chakma", "Noto Sans Cham", "Noto Sans Coptic", "Noto Sans Cuneiform", "Noto Sans Cypriot", "Noto Sans Duployan", "Noto Sans Egyptian Hieroglyphs", "Noto Sans Elbasan", "Noto Sans Glagolitic", "Noto Sans Gothic", "Noto Sans Gunjala Gondi", "Noto Sans Hanifi Rohingya", "Noto Sans Hanunoo", "Noto Sans Hatran", "Noto Sans Imperial Aramaic", "Noto Sans Inscriptional Pahlavi", "Noto Sans Inscriptional Parthian", "Noto Sans Javanese", "Noto Sans Kaithi", "Noto Sans Kannada", "Noto Sans Kayah Li", "Noto Sans Kharoshthi", "Noto Sans Khojki", "Noto Sans Khudawadi", "Noto Sans Lepcha", "Noto Sans Limbu", "Noto Sans Linear A", "Noto Sans Linear B", "Noto Sans Lisu", "Noto Sans Lycian", "Noto Sans Lydian", "Noto Sans Mahajani", "Noto Sans Mandaic", "Noto Sans Manichaean", "Noto Sans Marchen", "Noto Sans Masaram Gondi", "Noto Sans Meetei Mayek", "Noto Sans Mende Kikakui", "Noto Sans Meroitic", "Noto Sans Miao", "Noto Sans Modi", "Noto Sans Mongolian", "Noto Sans Mro", "Noto Sans Multani", "Noto Sans Myanmar", "Noto Sans Nabataean", "Noto Sans New Tai Lue", "Noto Sans Newa", "Noto Sans NKo", "Noto Sans Ol Chiki", "Noto Sans Old Hungarian", "Noto Sans Old Italic", "Noto Sans Old North Arabian", "Noto Sans Old Permic", "Noto Sans Old Persian", "Noto Sans Old South Arabian", "Noto Sans Old Turkic", "Noto Sans Oriya", "Noto Sans Osage", "Noto Sans Osmanya", "Noto Sans Pahawh Hmong", "Noto Sans Palmyrene", "Noto Sans Pau Cin Hau", "Noto Sans PhagsPa", "Noto Sans Phoenician", "Noto Sans Psalter Pahlavi", "Noto Sans Rejang", "Noto Sans Samaritan", "Noto Sans Saurashtra", "Noto Sans Sharada", "Noto Sans Siddham", "Noto Sans Sora Sompeng", "Noto Sans Sundanese", "Noto Sans Syloti Nagri", "Noto Sans Syriac", "Noto Sans Tagalog", "Noto Sans Tagbanwa", "Noto Sans Tai Le", "Noto Sans Tai Tham", "Noto Sans Tai Viet", "Noto Sans Takri", "Noto Sans Thaana", "Noto Sans Tifinagh", "Noto Sans Tirhuta", "Noto Sans Ugaritic", "Noto Sans Vai", "Noto Sans Wancho", "Noto Sans Warang Citi", "Noto Sans Yi", "Noto Sans Zawgyi", "Noto Serif Ahom", "Noto Serif Balinese", "Noto Serif Hmong Nyiakeng", "Noto Serif Kannada", "Noto Serif Myanmar", "Noto Serif Yezidi", "November Bangla Traditional",
+      "October Compressed Devanagari", "October Compressed Gujarati", "October Compressed Gurmukhi", "October Compressed Kannada", "October Compressed Meetei Mayek", "October Compressed Odia", "October Compressed Ol Chiki", "October Compressed Tamil", "October Compressed Telugu", "October Condensed Devanagari", "October Condensed Gujarati", "October Condensed Gurmukhi", "October Condensed Kannada", "October Condensed Meetei Mayek", "October Condensed Odia", "October Condensed Ol Chiki", "October Condensed Tamil", "October Condensed Telugu", "October Devanagari", "October Gujarati", "October Gurmukhi", "October Kannada", "October Meetei Mayek", "October Odia", "October Ol Chiki", "October Tamil", "October Telugu", "Optima", "Oriya MN", "Oriya Sangam MN", "Osaka", "Osaka-Mono",
+      "Padyakke Expanded One", "Palatino", "Papyrus", "Party LET", "PCMyungjo", "Phosphate", "PilGi", "PingFang HK", "PingFang MO", "PingFang SC", "PingFang TC", "Plantagenet Cherokee", "PortagoITC TT", "Princetown LET", "Produkt", "Proxima Nova", "PSL Ornanong Pro", "PT Mono", "PT Sans", "PT Sans Caption", "PT Sans Narrow", "PT Serif", "PT Serif Caption", "Publico Headline", "Publico Text",
+      "Quotes Caps", "Quotes Script",
+      "Raanana", "Raya", "Rockwell",
+      "Sama Devanagari", "Sama Gujarati", "Sama Gurmukhi", "Sama Kannada", "Sama Malayalam", "Sama Tamil", "Sana", "Santa Fe LET", "Sarabun", "Sathu", "Sauber Script", "Savoye LET", "Scheme", "SchoolHouse Cursive B", "SchoolHouse Printed A", "Seravek", "Shobhika", "Shree Devanagari 714", "SignPainter-HouseScript", "Silom", "SimSong", "Sinhala MN", "Sinhala Sangam MN", "Skia", "Snell Roundhand", "Somer", "Songti SC", "Songti TC", "Spot Mono", "Srisakdi", "STFangsong", "STHeiti", "STIXGeneral", "STIXIntegralsD", "STIXIntegralsSm", "STIXIntegralsUp", "STIXIntegralsUpD", "STIXIntegralsUpSm", "STIXNonUnicode", "STIXSizeFiveSym", "STIXSizeFourSym", "STIXSizeOneSym", "STIXSizeThreeSym", "STIXSizeTwoSym", "STIX Two Math", "STIX Two Text", "STIXVariants", "STKaiti", "STSong", "STXihei", "Stone Sans ITC TT", "Stone Sans Sem ITC TT", "Sukhumvit Set", "Superclarendon", "Symbol", "Synchro LET",
+      "Tahoma", "Tamil MN", "Tamil Sangam MN", "Telugu MN", "Telugu Sangam MN", "The Hand Serif", "Thonburi", "Times", "Times New Roman", "Tiro Bangla", "Tiro Devanagari Hindi", "Tiro Devanagari Marathi", "Tiro Devanagari Sanskrit", "Tiro Gurmukhi", "Tiro Kannada", "Tiro Tamil", "Tiro Telugu", "Toppan Bunkyu Gothic", "Toppan Bunkyu Midashi Gothic", "Toppan Bunkyu Midashi Mincho", "Toppan Bunkyu Mincho", "Trattatello", "Trebuchet MS", "Tsukushi A Round Gothic", "Tsukushi B Round Gothic", "Tw Cen MT", "Type Embellishments One LET",
+      "Verdana",
+      "Waseem", "Wawati SC", "Wawati TC", "Webdings", "Weibei SC", "Weibei TC", "Wingdings", "Wingdings 2", "Wingdings 3",
+      "Xingkai SC", "Xingkai TC",
+      "Yaziji", "Yuanti SC", "Yuanti TC", "YuGothic", "YuKyokasho", "YuKyokasho Yoko", "YuMincho", "YuMincho +36p Kana", "Yuppy SC", "Yuppy TC",
+      "Zapf Dingbats", "Zapfino", "Zawra"
+    };
+  } else if (platform == "linux") {
+    return {
+      // Ubuntu Font Family
+      "Ubuntu", "Ubuntu Condensed", "Ubuntu Light", "Ubuntu Mono", "Ubuntu Sans", "Ubuntu Sans Mono",
+      // DejaVu Family
+      "DejaVu Sans", "DejaVu Sans Condensed", "DejaVu Sans Light", "DejaVu Sans Mono",
+      "DejaVu Serif", "DejaVu Serif Condensed", "DejaVu Math TeX Gyre",
+      // Liberation Family
+      "Liberation Sans", "Liberation Sans Narrow", "Liberation Serif", "Liberation Mono",
+      // Noto Family
+      "Noto Sans", "Noto Sans Display", "Noto Sans Mono",
+      "Noto Serif", "Noto Serif Display", "Noto Mono", "Noto Color Emoji",
+      // Nimbus Family
+      "Nimbus Sans", "Nimbus Sans L", "Nimbus Sans Narrow", "Nimbus Roman", "Nimbus Roman No9 L",
+      "Nimbus Mono", "Nimbus Mono L", "Nimbus Mono PS",
+      // FreeFont Family
+      "FreeSans", "FreeSerif", "FreeMono"
+    };
+  }
+  return {};
+}
+
+// 判断是否为基础字体（不应被处理）
+static bool IsBasicFont(const std::string& font_family) {
+  static const std::set<std::string> basic_fonts = {
+    // 系统特殊字体
+    "-webkit-standard",
+    "system-ui",
+
+    // 基础西文字体
+    "Arial",
+    "Calibri",
+    "Courier New",
+    "Courier",
+    "Helvetica",
+    "Helvetica Neue",
+    "Lucida Grande",
+    "Microsoft Sans Serif",
+    "MS Sans Serif",
+    "MS Serif",
+    "MS UI Gothic",
+    "Roboto",
+    "Sans",
+    "Segoe UI",
+    "Times New Roman",
+    "Times",
+
+    // CSS通用字体
+    "cursive",
+    "fantasy",
+    "monospace",
+    "sans-serif",
+    "serif",
+    "math",
+
+    // 系统字体别名
+    "BlinkMacSystemFont"
+  };
+
+  return basic_fonts.count(font_family) > 0;
+}
+
+
 const FontPlatformData* FontCache::GetFontPlatformData(
     const FontDescription& font_description,
     const FontFaceCreationParams& creation_params,
@@ -165,6 +282,72 @@ const FontPlatformData* FontCache::GetFontPlatformData(
   }
 #endif
 
+  const base::CommandLine* command_line = base::CommandLine::ForCurrentProcess();
+  // 字体指纹处理逻辑 - 不应用于最后手段字体
+  if (command_line->HasSwitch(switches::kFingerprint) &&
+      creation_params.CreationType() == kCreateFontByFamily &&
+      alternate_font_name != AlternateFontName::kLastResort) {
+
+    const std::string requested_family = creation_params.Family().Utf8();
+
+    // 基础字体直接返回，不进行任何处理
+    if (IsBasicFont(requested_family)) {
+      return font_platform_data_cache_.GetOrCreateFontPlatformData(
+          this, font_description, creation_params, alternate_font_name);
+    }
+
+    // 检测当前操作系统
+    const char* current_os =
+#if BUILDFLAG(IS_WIN)
+      "windows";
+#elif BUILDFLAG(IS_MAC)
+      "macos";
+#elif BUILDFLAG(IS_LINUX) || BUILDFLAG(IS_CHROMEOS)
+      "linux";
+#else
+      "linux";  // 默认
+#endif
+
+
+    std::string spoofed_platform = command_line->GetSwitchValueASCII(switches::kFingerprintPlatform);
+    if (spoofed_platform.empty()) {
+      spoofed_platform = current_os;
+    }
+
+    std::vector<std::string> current_os_fonts = GetPlatformFonts(current_os);
+    std::vector<std::string> platform_fonts = GetPlatformFonts(spoofed_platform);
+
+    std::string fingerprint = command_line->GetSwitchValueASCII(switches::kFingerprint);
+    uint32_t hash = std::hash<std::string>{}(fingerprint + requested_family);
+
+    if (spoofed_platform != current_os) {
+      // 获取伪装平台的字体列表
+      bool is_platform_font = std::find(platform_fonts.begin(), platform_fonts.end(),
+                                        requested_family) != platform_fonts.end();
+      if (is_platform_font) {
+        // 伪装平台的字体，用当前系统的字体替代
+        size_t index = hash % current_os_fonts.size();
+        FontFaceCreationParams substitute_params(AtomicString(current_os_fonts[index].c_str()));
+        return font_platform_data_cache_.GetOrCreateFontPlatformData(
+            this, font_description, substitute_params, alternate_font_name);
+      } else {
+        // 非平台字体处理：95%概率隐藏
+        float probability = static_cast<float>(hash) / static_cast<float>(std::numeric_limits<uint32_t>::max());
+        if (probability < 0.95) {
+          return nullptr;
+        }
+        // 5%概率显示，继续默认流程
+      }
+    } else {
+      // 系统相同，随机隐藏2%的字体以生成指纹
+      float probability = static_cast<float>(hash) / static_cast<float>(std::numeric_limits<uint32_t>::max());
+      if (probability < 0.02) {
+        return nullptr;
+      }
+    }
+  }
+
+
   return font_platform_data_cache_.GetOrCreateFontPlatformData(
       this, font_description, creation_params, alternate_font_name);
 }
